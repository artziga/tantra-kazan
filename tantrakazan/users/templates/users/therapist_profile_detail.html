{% extends 'main/base.html' %}
{% load static %}


{% block content %}
 <title>{{ title }}</title>
  <section class="layout_padding-left">


    <div class="detail-container">

    <section class="section about-section gray-bg" id="about">
            <div class="container">

<input type="hidden" id="bookmark-data" value="{{ is_bookmarked|yesno:"1,0" }}">
<span id="bookmark-count">{{ count }}</span> в закладках
{{ is_bookmarked }}
{% if user.is_authenticated %}
<form method="post" action="{% url 'feedback:bookmark' therapist.pk content_type_id %}" class="bookmark-form" id="bookmark-form">
  {% csrf_token %}
  <input type="hidden" name="action" value="{% if is_bookmarked %}remove{% else %}add{% endif %}">
  <input type="image" src="{% if is_bookmarked %}{% static 'main/images/like-on.svg' %}{% else %}{% static 'main/images/like-off.svg' %}{% endif %}" height="20" alt="Отправить" id="bookmark-button">
</form>
{% else %}
  <p>Чтобы добавить в закладки, войдите в систему.</p>
{% endif %}



 <div class="container">
                <div class="row align-items-center flex-row-reverse">
                    <div class="col-lg-6">
                        <div class="about-text go-to">
                            <h3 class="dark-color">{{user.username}}</h3>
                            <h6 class="theme-color lead">{{user.therapist_profile.short_description}}</h6>
                            <div class="row about-list">
                                <div class="col-md-6">
                                    {% if user.therapist_profile.birth_date %}
                                    <div class="media">
                                        <label>День рождения</label>
                                        <p>{{user.therapist_profile.birth_date}}</p>
                                    </div>
                                    <div class="media">
                                        <label>Возраст</label>
                                        <p>{{user.therapist_profile.str_age}}</p>
                                    </div>
                                    {% endif %}
                                    <div class="media">
                                        <label>Residence</label>
                                        <p>Canada</p>
                                    </div>
                                    <div class="media">
                                        <label>Адрес</label>
                                        <p>{{user.therapist_profile.address}}</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="media">
                                        <label>E-mail</label>
                                        <p>{{user.email}}</p>
                                    </div>
                                    <div class="media">
                                        <label>Телефон</label>
                                        <p>{{user.therapist_profile.phone_number}}</p>
                                    </div>
                                    <div class="media">
                                        <label>Телеграм</label>
                                        <p>{{user.therapist_profile.telegram_profile}}</p>
                                    </div>
                                    <div class="media">
                                        <label>Инстаграм</label>
                                        <p>{{user.therapist_profile.instagram_profile}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                <div class="row align-items-center flex-row-reverse">
                        <div class="about-avatar">
                            {% if therapist.avatar %}
                            <img src="{{ therapist.avatar.image.url }}" height="400" title="" alt="">
                            {% else %}
                            <img src="{% static 'main/images/profile-icon.png' %}" height="400" title="" alt="">
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="counter">
                    <div class="row">

                            <p>{{ therapist.therapist_profile.description|safe }}</p>

                    </div>
            </div>
            </div>
        </section>
</section>
    {% include 'listings/listings_carousel.html' %}


 <!-- gallery section -->
       {% for gallery in galleries %}
        {% include 'gallery/gallery_carousel.html' %}
       {% endfor %}

{% include 'feedback/comments.html' %}



{% endblock content %}

{% block scripts %}

  <script> $(document).ready(function () {
  $("#bookmark-form").submit(function (event) {
    event.preventDefault();

    var form = $(this);
    var url = form.attr("action");

    $.ajax({
      type: "POST",
      url: url,
      data: form.serialize(),
      dataType: "json",
      success: function (data) {
        // Обновите отображаемые результаты на странице
        $("#bookmark-data").val(data.result);
        $("#bookmark-count").text(data.count); // Обновление количества

        // Обновите изображение на кнопке
        var button = $("#bookmark-button");
        if (data.result) {
          button.attr("src", "{% static 'main/images/like-on.svg' %}");
          button.attr("alt", "Удалить из закладок");
        } else {
          button.attr("src", "{% static 'main/images/like-off.svg' %}");
          button.attr("alt", "Добавить в закладки");
        }
      },
      error: function (xhr, textStatus, errorThrown) {
        // Обработка ошибки, если не удалось отправить запрос
        console.error("Произошла ошибка: " + errorThrown);
      }
    });
  });
});
</script>

{% endblock scripts %}


